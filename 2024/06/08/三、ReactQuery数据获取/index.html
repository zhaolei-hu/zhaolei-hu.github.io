<!doctype html>
<html lang="zh"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>三、ReactQuery数据获取 - 「胡」说</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="「胡」说"><meta name="msapplication-TileImage" content="/img/favicon.ico"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="「胡」说"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="React Query 有三个核心概念：  Queries - 查 Mutations - 增删改 Query Invalidation - 查询失效（重新查询）"><meta property="og:type" content="blog"><meta property="og:title" content="三、ReactQuery数据获取"><meta property="og:url" content="https://zhaolei-hu.github.io/2024/06/08/%E4%B8%89%E3%80%81ReactQuery%E6%95%B0%E6%8D%AE%E8%8E%B7%E5%8F%96/"><meta property="og:site_name" content="「胡」说"><meta property="og:description" content="React Query 有三个核心概念：  Queries - 查 Mutations - 增删改 Query Invalidation - 查询失效（重新查询）"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://zhaolei-hu.github.io/img/og_image.png"><meta property="article:published_time" content="2024-06-08T02:14:37.000Z"><meta property="article:modified_time" content="2024-06-21T03:51:08.660Z"><meta property="article:author" content="胡兆磊"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="/img/og_image.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://zhaolei-hu.github.io/2024/06/08/%E4%B8%89%E3%80%81ReactQuery%E6%95%B0%E6%8D%AE%E8%8E%B7%E5%8F%96/"},"headline":"三、ReactQuery数据获取","image":["https://zhaolei-hu.github.io/img/og_image.png"],"datePublished":"2024-06-08T02:14:37.000Z","dateModified":"2024-06-21T03:51:08.660Z","author":{"@type":"Person","name":"胡兆磊"},"publisher":{"@type":"Organization","name":"「胡」说","logo":{"@type":"ImageObject","url":{"text":"「胡」说"}}},"description":"React Query 有三个核心概念：  Queries - 查 Mutations - 增删改 Query Invalidation - 查询失效（重新查询）"}</script><link rel="canonical" href="https://zhaolei-hu.github.io/2024/06/08/%E4%B8%89%E3%80%81ReactQuery%E6%95%B0%E6%8D%AE%E8%8E%B7%E5%8F%96/"><link rel="icon" href="/img/favicon.ico"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/font-awesome/5.15.2/css/all.min.css"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/atom-one-light.min.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/cookieconsent/3.1.1/cookieconsent.min.css"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/lightgallery/1.6.8/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/justifiedGallery/3.7.0/css/justifiedGallery.min.css"><!--!--><!--!--><script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/pace.min.js"></script><!--!--><!--!--><meta name="generator" content="Hexo 5.4.0"></head><body class="is-3-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/">「胡」说</a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">首页</a><a class="navbar-item" href="/archives">归档</a><a class="navbar-item" href="/categories">分类</a><a class="navbar-item" href="/tags">标签</a></div><div class="navbar-end"><a class="navbar-item is-hidden-tablet catalogue" title="目录" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item search" title="搜索" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-6-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2024-06-08T02:14:37.000Z" title="2024/6/8 10:14:37">2024-06-08</time>发表</span><span class="level-item"><time dateTime="2024-06-21T03:51:08.660Z" title="2024/6/21 11:51:08">2024-06-21</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/NextJs%E5%85%A8%E6%A0%88%E5%BC%80%E5%8F%91/">NextJs全栈开发</a></span><span class="level-item">25 分钟读完 (大约3708个字)</span></div></div><h1 class="title is-3 is-size-4-mobile">三、ReactQuery数据获取</h1><div class="content"><p><code>React Query</code> 有三个核心概念：</p>
<ul>
<li><code>Queries</code> - 查</li>
<li><code>Mutations</code> - 增删改</li>
<li><code>Query Invalidation</code> - 查询失效（重新查询）</li>
</ul>
<span id="more"></span>

<p><code>TanStack Query</code> 目前支持多种前端框架，我们本章节专注适用于 <code>React</code> 的 <code>React Query</code> 并会在需要做示例的时候使用 <code>Nextjs</code> 示例。</p>
<h2 id="快速上手"><a href="#快速上手" class="headerlink" title="快速上手"></a>快速上手</h2><p>我们先以官方文档的 <code>Quick Start</code> 示例来演示三个核心概念：</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">  useQuery,</span><br><span class="line">  useMutation,</span><br><span class="line">  useQueryClient,</span><br><span class="line">  QueryClient,</span><br><span class="line">  QueryClientProvider,</span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">&#x27;@tanstack/react-query&#x27;</span></span><br><span class="line"><span class="comment">// 引入发送请求的API，具体的API内容不关注</span></span><br><span class="line"><span class="keyword">import</span> &#123; getTodos, postTodo &#125; <span class="keyword">from</span> <span class="string">&#x27;../my-api&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建 Query Client实例</span></span><br><span class="line"><span class="keyword">const</span> queryClient = <span class="keyword">new</span> QueryClient()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">App</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="comment">// 在App组件将queryClient注入</span></span><br><span class="line">    <span class="xml"><span class="tag">&lt;<span class="name">QueryClientProvider</span> <span class="attr">client</span>=<span class="string">&#123;queryClient&#125;</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">Todos</span> /&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">QueryClientProvider</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Todos</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="comment">// 在我们的业务组件中获取到queryClient实例</span></span><br><span class="line">  <span class="keyword">const</span> queryClient = useQueryClient()</span><br><span class="line"></span><br><span class="line">  <span class="comment">// useQuery用于发送查询请求，对应核心概念之一的 Queries</span></span><br><span class="line">  <span class="comment">// 会调用queryFn的请求方法，并且拥有自己的queryKey</span></span><br><span class="line">  <span class="keyword">const</span> query = useQuery(&#123; <span class="attr">queryKey</span>: [<span class="string">&#x27;todos&#x27;</span>], <span class="attr">queryFn</span>: getTodos &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// useMutation用于创建一个mutation，其功能对应核心概念的 Mutations</span></span><br><span class="line">  <span class="comment">// mutationFn是执行mutation的时候要调用的函数，但是不会在useMutation的时候立即执行，需要我们在合适的时机手动执行</span></span><br><span class="line">  <span class="comment">// onSuccess是mutationFn执行成功之后的回调</span></span><br><span class="line">  <span class="keyword">const</span> mutation = useMutation(&#123;</span><br><span class="line">    <span class="attr">mutationFn</span>: postTodo,</span><br><span class="line">    <span class="attr">onSuccess</span>: <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">// queryClient.invalidateQueries可以使指定queryKey的请求失效，失效后会重新执行query请求</span></span><br><span class="line">      <span class="comment">// 在这里就是重新执行我们的 getTodos</span></span><br><span class="line">      queryClient.invalidateQueries(&#123; <span class="attr">queryKey</span>: [<span class="string">&#x27;todos&#x27;</span>] &#125;)</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">      &#123;/* query查询的结果可以用来渲染，查询成功后会自动更新 */&#125;</span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">ul</span>&gt;</span>&#123;query.data?.map((todo) =&gt; <span class="tag">&lt;<span class="name">li</span> <span class="attr">key</span>=<span class="string">&#123;todo.id&#125;</span>&gt;</span>&#123;todo.title&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span>)&#125;<span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">button</span></span></span></span><br><span class="line"><span class="tag"><span class="xml">        <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="xml">          &#123;/* mutation.mutate手动执行一个mutation，用于实现增删改操作，传递的参数会传递给mutationFn */&#125;</span></span><br><span class="line"><span class="xml">          mutation.mutate(&#123;</span></span><br><span class="line"><span class="xml">            id: Date.now(),</span></span><br><span class="line"><span class="xml">            title: &#x27;Do Laundry&#x27;,</span></span><br><span class="line"><span class="xml">          &#125;)</span></span><br><span class="line"><span class="xml">        &#125;&#125;</span></span><br><span class="line"><span class="xml">      &gt;</span></span><br><span class="line"><span class="xml">        Add Todo</span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">render(<span class="xml"><span class="tag">&lt;<span class="name">App</span> /&gt;</span></span>, <span class="built_in">document</span>.getElementById(<span class="string">&#x27;root&#x27;</span>))</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>在示例代码中，我在适当位置做了注释，查看注释即可。</p>
<h2 id="Nextjs-引入-React-Query"><a href="#Nextjs-引入-React-Query" class="headerlink" title="Nextjs 引入 React Query"></a>Nextjs 引入 React Query</h2><p>由于 <code>React Query</code> 需要用于客户端组件，所以我们不能直接在 <code>app/layout.tsx</code> 中注入，我们可以在封装一层组件</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// components/query-provider.tsx</span></span><br><span class="line"><span class="string">&#x27;use client&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; QueryClient, QueryClientProvider &#125; <span class="keyword">from</span> <span class="string">&#x27;@tanstack/react-query&#x27;</span></span><br><span class="line"><span class="keyword">const</span> queryClient = <span class="keyword">new</span> QueryClient()</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">QueryProvider</span>(<span class="params">&#123;children&#125;: &#123;children: React.ReactNode&#125;</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="xml"><span class="tag">&lt;<span class="name">QueryClientProvider</span> <span class="attr">client</span>=<span class="string">&#123;queryClient&#125;</span>&gt;</span></span></span><br><span class="line"><span class="xml">      &#123;children&#125;</span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">QueryClientProvider</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>然后我们在<code>root layout</code>中引入使用:</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// app/layout.tsx</span></span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">RootLayout</span>(<span class="params">&#123;</span></span></span><br><span class="line"><span class="params"><span class="function">  children,</span></span></span><br><span class="line"><span class="params"><span class="function">&#125;: Readonly&lt;&#123;</span></span></span><br><span class="line"><span class="params"><span class="function">  children: React.ReactNode;</span></span></span><br><span class="line"><span class="params"><span class="function">&#125;&gt;</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="xml"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">body</span> <span class="attr">className</span>=<span class="string">&#123;cn(</span></span></span></span><br><span class="line"><span class="tag"><span class="xml">          &quot;<span class="attr">min-h-screen</span> <span class="attr">bg-background</span> <span class="attr">font-sans</span> <span class="attr">antialiased</span>&quot;,</span></span></span><br><span class="line"><span class="tag"><span class="xml">          <span class="attr">fontSans.variable</span></span></span></span><br><span class="line"><span class="tag"><span class="xml">        )&#125;&gt;</span></span></span><br><span class="line"><span class="xml">          <span class="tag">&lt;<span class="name">QueryProvider</span>&gt;</span></span></span><br><span class="line"><span class="xml">            &#123;children&#125;</span></span><br><span class="line"><span class="xml">          <span class="tag">&lt;/<span class="name">QueryProvider</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">html</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这样就可以在业务组件中使用 <code>React Query</code> 了</p>
<h2 id="查"><a href="#查" class="headerlink" title="查"></a>查</h2><p><code>Query</code>可以和任何基于<code>Promise</code>的方法（包括<code>GET, POST</code>）一起使用，以从服务器获取数据。如果方法修改了服务器的数据，那么建议使用<code>Mutations</code>而不是<code>Query</code>。</p>
<p>使用<code>useQuery</code>至少需要提供：</p>
<ul>
<li>查询的唯一<code>key</code> - <code>queryKey</code> 这个唯一的<code>key</code>在内部用于整个应用程序重新提取、缓存和共享查询</li>
<li>返回<code>Promise</code>的函数，他应该解析数据或抛出错误 - <code>queryFn</code></li>
</ul>
<h3 id="useQuery-返回值"><a href="#useQuery-返回值" class="headerlink" title="useQuery 返回值"></a>useQuery 返回值</h3><p><code>useQuery</code>返回的查询结果有所有需要的信息：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">const &#123;isPending, isError, isSucess, status, error, data, isFetching&#125; = useQuery()</span><br></pre></td></tr></table></figure>

<p>在任何时刻，查询只能处于以下状态之一：</p>
<ul>
<li><code>isPending</code>或者<code>status === &#39;pending&#39;</code> - 尚无查询数据</li>
<li><code>isError</code>或者<code>status === &#39;error&#39;</code> - 查询遇到错误</li>
<li><code>isSuccess</code>或者<code>status === &#39;success&#39;</code> - 查询成功且数据可用</li>
</ul>
<p>除了上边的状态之外，还可以根据状态来获取更多信息：</p>
<ul>
<li><code>error</code> - 处于<code>isError</code>状态时可以通过<code>error</code>获取错误</li>
<li><code>data</code> - 处于<code>isSuccess</code>状态时可以通过<code>data</code>获取错误</li>
<li><code>isFetching</code> - 如果查询正在获取数据，则<code>isFetching = true</code></li>
</ul>
<blockquote>
<p>通常只需要检查<code>isPending</code>状态，然后检查<code>isError</code>状态，最后假定数据可用并呈现即可。</p>
<p>检查状态可以用<code>isPending, isError</code>等布尔值，也可以用<code>status</code>，两者取其一即可。</p>
</blockquote>
<h3 id="queryKey"><a href="#queryKey" class="headerlink" title="queryKey"></a>queryKey</h3><p><code>react-query</code>的核心是根据查询键管理查询缓存。查询键必须是顶层的数组。可以只包含简单的字符串，也可以和嵌套对象的数组一样复杂。只要<strong>是可序列化的，并且对于查询的数据是唯一的</strong>，就可以使用：</p>
<ul>
<li><p>具有常量值的数组</p>
</li>
<li><p>当查询需要更多信息来唯一描述其数据时，可以使用带有字符串和任意数量的可序列化对象的数组来描述它</p>
</li>
<li><p>如果查询函数依赖于变量， 请将其包含在查询键中</p>
</li>
</ul>
<h3 id="queryFn"><a href="#queryFn" class="headerlink" title="queryFn"></a>queryFn</h3><p>查询函数可以是返回<code>Promise</code>的任意函数，这个<code>Promise</code>必须返回数据或者抛出错误</p>
<p><code>queryKey</code> 不仅用于标识想要获取的数据，还可以作为<code>QueryFunctionContext</code>的一部分传递到查询函数中。</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">useQuery(&#123;</span><br><span class="line">  <span class="attr">queryKey</span>: [],</span><br><span class="line">  <span class="attr">queryFn</span>: <span class="keyword">async</span> (context: QueryFunctionContext) =&gt; &#123;&#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p><code>QueryFunctionContext</code>是传递给每个查询函数的对象，包括：</p>
<ul>
<li><code>queryKey: QueryKey</code>  - 查询键</li>
<li><code>signal?: AbortSignal</code> - 用于取消查询</li>
<li><code>meta: Record&lt;string, unknown&gt; | undefined</code> - 可以填写有关查询的其他信息</li>
</ul>
<p>另外，<code>Infinite Queries</code>无限查询会额外传递参数：</p>
<ul>
<li><code>pageParam: TPageParam</code> - 提取当前页面的<code>page</code>参数</li>
<li><code>direction: &#39;forward&#39; | &#39;backward&#39;</code> - 页面数据的提取方向</li>
</ul>
<p>读取<code>queryKey</code>的示例：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">const [page, setPage] = useState(1)</span><br><span class="line">useQuery(&#123;</span><br><span class="line">  queryKey: [&#x27;todos&#x27;, page, &#123; page &#125;, &#x27;others&#x27;],</span><br><span class="line">  queryFn: async (&#123;queryKey&#125;: QueryFunctionContext) =&gt; &#123;</span><br><span class="line">    // [&#x27;todos&#x27;, 1, &#123; page: 1 &#125;, &#x27;others&#x27;]</span><br><span class="line">    console.log(queryKey)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>接收到的<code>queryKey</code>与定义的完全一致，依然是数组，顺序保持一致。</p>
</blockquote>
<h3 id="query-options"><a href="#query-options" class="headerlink" title="query options"></a>query options</h3><p>在多个位置之间共享 <code>queryKey</code> 和 <code>queryFn</code> 但使它们彼此位于同一位置的最佳方法之一是使用 <code>queryOptions</code> 帮助程序。在运行时，这个帮助程序只返回你传递给它的任何内容，但它在与<code> TypeScript</code> 一起使用时有很多优点。您可以在一个位置定义查询的所有可能选项，并且将获取所有这些选项的类型推断和类型安全</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; queryOptions &#125; <span class="keyword">from</span> <span class="string">&#x27;@tanstack/react-query&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">groupOptions</span>(<span class="params">id: <span class="built_in">number</span></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> queryOptions(&#123;</span><br><span class="line">    <span class="attr">queryKey</span>: [<span class="string">&#x27;groups&#x27;</span>, id],</span><br><span class="line">    <span class="attr">queryFn</span>: <span class="function">() =&gt;</span> fetchGroups(id),</span><br><span class="line">    <span class="attr">staleTime</span>: <span class="number">5</span> * <span class="number">1000</span>,</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// usage:</span></span><br><span class="line">useQuery(groupOptions(<span class="number">1</span>))</span><br><span class="line">useQuery(groupOptions(<span class="number">5</span>))</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p>对于无限查询，可以使用单独的<code>infiniteQueryOptions</code>帮助程序。</p>
</blockquote>
<h3 id="并行查询"><a href="#并行查询" class="headerlink" title="并行查询"></a>并行查询</h3><p>并行执行查询，最大限度提高查询的并发性。</p>
<h4 id="手动并行查询"><a href="#手动并行查询" class="headerlink" title="手动并行查询"></a>手动并行查询</h4><p>当并行查询数量没有变化时，不需要做任何工作，只要并排使用任意数量的<code>useQuery</code>或者<code>useinfiniteQuery</code>即可</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> usersQuery = useQuery()</span><br><span class="line"><span class="keyword">const</span> teamsQuery = useQuery()</span><br><span class="line"><span class="keyword">const</span> projectsQuery = useQuery()</span><br><span class="line">...</span><br></pre></td></tr></table></figure>



<h4 id="使用useQueries进行动态并行查询"><a href="#使用useQueries进行动态并行查询" class="headerlink" title="使用useQueries进行动态并行查询"></a>使用<code>useQueries</code>进行动态并行查询</h4><p>当需要执行的查询数量在不同渲染之间会发生变化，那么不能用手动查询了，可以使用<code>useQueries</code>这个<code>hook</code>，他可以动态执行任意数量的查询。</p>
<p><code>useQueries</code>接收一个带有<code>queries</code>字段的对象，其值是一个查询对象数组。返回查询结果数组：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">function App(&#123; users &#125;) &#123;</span><br><span class="line">  const userQueries = useQueries(&#123;</span><br><span class="line">    queries: users.map(user =&gt; &#123;</span><br><span class="line">      return &#123;</span><br><span class="line">        queryKey: [&#x27;user&#x27;, user.id],</span><br><span class="line">        queryFn: () =&gt; fetchUserById(user.id)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>这里用的是<code>props</code>来动态生成的请求查询，当然可以根据<code>state</code>或者其他来动态生成查询。</p>
</blockquote>
<h3 id="串行查询"><a href="#串行查询" class="headerlink" title="串行查询"></a>串行查询</h3><p>依赖于先前的查询在执行之前完成。</p>
<h4 id="useQuery-依赖查询"><a href="#useQuery-依赖查询" class="headerlink" title="useQuery 依赖查询"></a>useQuery 依赖查询</h4><p>只需要使用<code>enabled</code>来告知查询何时准备好运行即可。</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 获取 user</span></span><br><span class="line"><span class="keyword">const</span> &#123; <span class="attr">data</span>: user &#125; = useQuery(&#123;</span><br><span class="line">  <span class="attr">queryKey</span>: [<span class="string">&#x27;user&#x27;</span>, email],</span><br><span class="line">  <span class="attr">queryFn</span>: getUserByEmail</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> userId = user?.id</span><br><span class="line"></span><br><span class="line"><span class="comment">// 获取 user projects</span></span><br><span class="line"><span class="keyword">const</span> &#123;&#125; = useQuery(&#123;</span><br><span class="line">  <span class="attr">queryKey</span>: [<span class="string">&#x27;projects&#x27;</span>, userId],</span><br><span class="line">  <span class="attr">queryFn</span>: getProjectsByUser,</span><br><span class="line">  <span class="comment">// 直到 userId 存在了才会执行查询</span></span><br><span class="line">  <span class="attr">enabled</span>: !!userId,</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>



<h4 id="useQueries依赖查询"><a href="#useQueries依赖查询" class="headerlink" title="useQueries依赖查询"></a>useQueries依赖查询</h4><p><code>useQueries</code>也可以依赖于以前的查询，实现方法：</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 获取 user ids</span></span><br><span class="line"><span class="keyword">const</span> &#123; <span class="attr">data</span>: userIds &#125; = useQuery(&#123;</span><br><span class="line">  <span class="attr">queryKey</span>: [<span class="string">&#x27;users&#x27;</span>],</span><br><span class="line">  <span class="attr">queryFn</span>: getUsersData,</span><br><span class="line">  <span class="attr">select</span>: <span class="function">(<span class="params">users</span>) =&gt;</span> users.map(<span class="function"><span class="params">user</span> =&gt;</span> user.id),</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 然后获取用户信息</span></span><br><span class="line"><span class="keyword">const</span> usersMessage = useQueries(&#123;</span><br><span class="line">  <span class="attr">queries</span>: userIds</span><br><span class="line">  	? userIds.map(<span class="function"><span class="params">id</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> &#123;</span><br><span class="line">        <span class="attr">queryKey</span>: [<span class="string">&#x27;message&#x27;</span>, id],</span><br><span class="line">        <span class="attr">queryFn</span>: <span class="function">() =&gt;</span> getMessageByUsers(id)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">  	: [] <span class="comment">// 如果没有userIds则返回空数组</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>



<h3 id="初始数据"><a href="#初始数据" class="headerlink" title="初始数据"></a>初始数据</h3><p>使用 <code>config.initialData</code> 选项来设置查询的初始数据并跳过初始加载状态</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> result = useQuery(&#123;</span><br><span class="line">  <span class="attr">queryKey</span>: [<span class="string">&#x27;todos&#x27;</span>],</span><br><span class="line">  <span class="attr">queryFn</span>: <span class="function">() =&gt;</span> fetch(<span class="string">&#x27;/todos&#x27;</span>),</span><br><span class="line">  <span class="attr">initialData</span>: initialTodos,</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<blockquote>
<p><code>initialData</code>将保存在缓存中，因此不建议向此选项提供占位符或不完整数据，而应该使用<code>placeholderData</code></p>
</blockquote>
<h3 id="占位数据"><a href="#占位数据" class="headerlink" title="占位数据"></a>占位数据</h3><p>类似于 <code>initialData</code> 选项，但<strong>数据不会保存到缓存中</strong>。当您有足够的部分（或虚假）数据来成功呈现查询，而实际数据是在后台获取时，这会派上用场</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Todos</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> result = useQuery(&#123;</span><br><span class="line">    <span class="attr">queryKey</span>: [<span class="string">&#x27;todos&#x27;</span>],</span><br><span class="line">    <span class="attr">queryFn</span>: <span class="function">() =&gt;</span> fetch(<span class="string">&#x27;/todos&#x27;</span>),</span><br><span class="line">    <span class="attr">placeholderData</span>: placeholderTodos,</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>如果访问查询占位符数据的过程非常密集，或者您不想在每次渲染时都执行，则可以记住该值：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">function Todos() &#123;</span><br><span class="line">  const placeholderData = useMemo(() =&gt; generateFakeTodos(), [])</span><br><span class="line">  const result = useQuery(&#123;</span><br><span class="line">    queryKey: [&#x27;todos&#x27;],</span><br><span class="line">    queryFn: () =&gt; fetch(&#x27;/todos&#x27;),</span><br><span class="line">    placeholderData,</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>placeholderData</code> 也可以是一个函数，您可以在其中访问“上一个”成功 <code>Query</code> 的数据和 <code>Query</code> 元信息。对于希望将一个查询中的数据用作另一个查询的占位符数据的情况，这很有用。当 QueryKey 发生变化时，例如从 [‘<code>[&#39;todos&#39;, 1]</code>， <code>[&#39;todos&#39;, 2]</code>，我们可以继续显示“旧”数据，而不必在数据从一个查询<em>转换</em>到下一个查询时显示加载器。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">const result = useQuery(&#123;</span><br><span class="line">  queryKey: [&#x27;todos&#x27;, id],</span><br><span class="line">  queryFn: () =&gt; fetch(`/todos/$&#123;id&#125;`),</span><br><span class="line">  placeholderData: (previousData, previousQuery) =&gt; previousData,</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>在某些情况下，您可以根据另一个查询的缓存结果提供占位符数据。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">function Todo(&#123; blogPostId &#125;) &#123;</span><br><span class="line">  const queryClient = useQueryClient();</span><br><span class="line">  const result = useQuery(&#123;</span><br><span class="line">    queryKey: [&#x27;blogPost&#x27;, blogPostId],</span><br><span class="line">    queryFn: () =&gt; fetch(`/blogPosts/$&#123;blogPostId&#125;`),</span><br><span class="line">    placeholderData: () =&gt; &#123;</span><br><span class="line">      // Use the smaller/preview version of the blogPost from the &#x27;blogPosts&#x27;</span><br><span class="line">      // query as the placeholder data for this blogPost query</span><br><span class="line">      return queryClient</span><br><span class="line">        .getQueryData([&#x27;blogPosts&#x27;])</span><br><span class="line">        ?.find((d) =&gt; d.id === blogPostId)</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h3 id="分页查询"><a href="#分页查询" class="headerlink" title="分页查询"></a>分页查询</h3><p>分页数据是非常常见的，在<code>React Query</code>中通过在查询键中包含分页信息来实现：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">const result = useQuery(&#123;</span><br><span class="line">  queryKey: [&#x27;projects&#x27;, page],</span><br><span class="line">  queryFn: fetchProjects</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>这样确实可以工作，但是会发生一些奇怪的情况，<strong>页码改变时<code>UI</code> 跳入和跳出<code>success</code>和<code>pending</code>状态，因为每个新页面都被视为一个全新的查询。</strong></p>
<p>这种体验是不佳的，<code>React Query</code>中有名为<code>placeholderData</code>的功能，可以解决这个问题。</p>
<p>思路：</p>
<ul>
<li><strong>在请求新数据时，上次成功提取的数据可用，即使查询键已更改也是如此</strong>.</li>
<li>当新数据到达时，以前的数据将无缝交换以显示新<code>data</code>。</li>
<li><code>isPlaceholderData</code> 可用于了解查询当前为您提供的数据</li>
</ul>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; keepPreviousData, useQuery &#125; <span class="keyword">from</span> <span class="string">&quot;@tanstack/react-query&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Todos</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> [page, setPage] = React.useState(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> fetchProjects = <span class="function">(<span class="params">page = <span class="number">0</span></span>) =&gt;</span> fetch(<span class="string">&#x27;/api/projects?page=&#x27;</span> + page).then(<span class="function">(<span class="params">res</span>) =&gt;</span> res.json())</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> &#123;</span><br><span class="line">    isPending,</span><br><span class="line">    isError,</span><br><span class="line">    error,</span><br><span class="line">    data,</span><br><span class="line">    isFetching,</span><br><span class="line">    isPlaceholderData,</span><br><span class="line">  &#125; = useQuery(&#123;</span><br><span class="line">    <span class="attr">queryKey</span>: [<span class="string">&#x27;projects&#x27;</span>, page],</span><br><span class="line">    <span class="attr">queryFn</span>: <span class="function">() =&gt;</span> fetchProjects(page),</span><br><span class="line">    <span class="attr">placeholderData</span>: keepPreviousData,</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">      &#123;isPending ? (</span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">div</span>&gt;</span>Loading...<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">      ) : isError ? (</span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">div</span>&gt;</span>Error: &#123;error.message&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">      ) : (</span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">          &#123;data.projects.map(project =&gt; (</span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">p</span> <span class="attr">key</span>=<span class="string">&#123;project.id&#125;</span>&gt;</span>&#123;project.name&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="xml">          ))&#125;</span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">      )&#125;</span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">span</span>&gt;</span>Current Page: &#123;page + 1&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">button</span></span></span></span><br><span class="line"><span class="tag"><span class="xml">        <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> setPage(old =&gt; Math.max(old - 1, 0))&#125;</span></span><br><span class="line"><span class="xml">        disabled=&#123;page === 0&#125;</span></span><br><span class="line"><span class="xml">      &gt;</span></span><br><span class="line"><span class="xml">        Previous Page</span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;/<span class="name">button</span>&gt;</span>&#123;&#x27; &#x27;&#125;</span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">button</span></span></span></span><br><span class="line"><span class="tag"><span class="xml">        <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="xml">          if (!isPlaceholderData &amp;&amp; data.hasMore) &#123;</span></span><br><span class="line"><span class="xml">            setPage(old =&gt; old + 1)</span></span><br><span class="line"><span class="xml">          &#125;</span></span><br><span class="line"><span class="xml">        &#125;&#125;</span></span><br><span class="line"><span class="xml">        disabled=&#123;isPlaceholderData || !data?.hasMore&#125;</span></span><br><span class="line"><span class="xml">      &gt;</span></span><br><span class="line"><span class="xml">        Next Page</span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="xml">      &#123;isFetching ? <span class="tag">&lt;<span class="name">span</span>&gt;</span> Loading...<span class="tag">&lt;/<span class="name">span</span>&gt;</span> : null&#125;&#123;&#x27; &#x27;&#125;</span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>将<code>keepPreviousData</code>设置为<code>placeholderData</code>，会在之后的请求过程中用当前的数据进行占位。</p>
<p>通过<code>isPlaceholderData</code>判断是否是占位数据</p>
</blockquote>
<blockquote>
<p>关于 <code>Query</code> 的内容就先说这么多吧，这些是常用内容，当然 <code>React Query</code> 支持更多的配置项和操作，自己查阅文档吧</p>
</blockquote>
<h2 id="增删改"><a href="#增删改" class="headerlink" title="增删改"></a>增删改</h2><p>与<code>Query</code>不同，<code>Mutation</code>通常用于 增删改 或 执行服务器副作用。使用<code>useMutation</code>这个<code>hook</code>。</p>
<p>在任何给定时刻，<code>Mutation</code>只能处于以下状态之一：</p>
<ul>
<li><code>isIdle</code> or <code>status === &#39;idle&#39;</code> - 当前处于空闲状态或处于全新/重置状态</li>
<li><code>isPending</code> 或 <code>status === &#39;pending&#39;</code> - 当前正在运行</li>
<li><code>isError</code> 或 <code>status === &#39;error&#39;</code> - 遇到错误</li>
<li><code>isSuccess</code> 或<code>status === &#39;success&#39;</code> - 成功且数据可用</li>
</ul>
<p>除了这些主要状态之外，根据<code>Mutation</code>的状态，还可以获得更多信息：</p>
<ul>
<li><code>error</code> - 如果处于错误状态，则可通过 <code>error</code> 属性获取该<code>error</code>。</li>
<li><code>data</code> - 如果处于<code>success</code>状态，则可通过 <code>data</code> 属性获取数据</li>
</ul>
<p>即使只有变量，<code>Mutation</code>也不是那么特别，但是当与 <code>onSuccess</code> 选项、查询客户端的 <code>invalidateQueries</code> 方法和查询客户端的<code>setQueryData</code> 方法一起使用时，<code>Mutation</code>会成为一个非常强大的工具。</p>
<h3 id="基础使用"><a href="#基础使用" class="headerlink" title="基础使用"></a>基础使用</h3><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> CreateTodo = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> [title, setTitle] = useState(<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">  <span class="keyword">const</span> mutation = useMutation(&#123; <span class="attr">mutationFn</span>: createTodo &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> onCreateTodo = <span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span><br><span class="line">    e.preventDefault()</span><br><span class="line">    mutation.mutate(&#123; title &#125;)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="xml"><span class="tag">&lt;<span class="name">form</span> <span class="attr">onSubmit</span>=<span class="string">&#123;onCreateTodo&#125;</span>&gt;</span></span></span><br><span class="line"><span class="xml">      &#123;mutation.error &amp;&amp; (</span></span><br><span class="line"><span class="xml">        /*使用reset方法重置*/</span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">h5</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> mutation.reset()&#125;&gt;&#123;mutation.error&#125;<span class="tag">&lt;/<span class="name">h5</span>&gt;</span></span></span><br><span class="line"><span class="xml">      )&#125;</span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">input</span></span></span></span><br><span class="line"><span class="tag"><span class="xml">        <span class="attr">type</span>=<span class="string">&quot;text&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="xml">        <span class="attr">value</span>=<span class="string">&#123;title&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="xml">        <span class="attr">onChange</span>=<span class="string">&#123;(e)</span> =&gt;</span> setTitle(e.target.value)&#125;</span></span><br><span class="line"><span class="xml">      /&gt;</span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">br</span> /&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span>&gt;</span>Create Todo<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="回调"><a href="#回调" class="headerlink" title="回调"></a>回调</h3><p>在调用 <code>mutate</code> 时，除了 <code>useMutation</code> 上定义的回调之外，还<strong>希望触发其他回调</strong>。这可用于触发特定于组件的副作用。为此，您可以在 <code>mutation</code> 变量之后为 <code>mutate</code> 函数提供任何相同的回调选项。支持的选项包括：<code>onSuccess</code>、<code>onError</code> 和 <code>onSettled</code>。请记住，如果您的组件在变更完成<em>之前</em>卸载，这些额外的回调将不会运行。</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> mutation = useMutation(&#123;</span><br><span class="line">  <span class="attr">mutationFn</span>: addTodo,</span><br><span class="line">  <span class="comment">// 所有调用mutation.mutate()都会触发下边的回调</span></span><br><span class="line">  <span class="attr">onSuccess</span>: <span class="function">(<span class="params">data, variables, context</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// I will fire first</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">onError</span>: <span class="function">(<span class="params">error, variables, context</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// I will fire first</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">onSettled</span>: <span class="function">(<span class="params">data, error, variables, context</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// I will fire first</span></span><br><span class="line">  &#125;,</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">mutation.mutate(todo, &#123;</span><br><span class="line">  <span class="comment">// 仅用于当前mutate的回调</span></span><br><span class="line">  <span class="attr">onSuccess</span>: <span class="function">(<span class="params">data, variables, context</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// I will fire second!</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">onError</span>: <span class="function">(<span class="params">error, variables, context</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// I will fire second!</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">onSettled</span>: <span class="function">(<span class="params">data, error, variables, context</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// I will fire second!</span></span><br><span class="line">  &#125;,</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>



<h2 id="查询失效"><a href="#查询失效" class="headerlink" title="查询失效"></a>查询失效</h2><p>当您知道查询的数据由于用户执行的操作而过期时。为此，<code>QueryClient</code> 有一个 <code>invalidateQueries</code> 方法，该方法允许您智能地将查询标记为过时，并可能重新获取它们</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 将缓存中的所有查询标记为过时</span></span><br><span class="line">queryClient.invalidateQueries()</span><br><span class="line"><span class="comment">// 通过queryKey将指定查询标记为过时</span></span><br><span class="line">queryClient.invalidateQueries(&#123; <span class="attr">queryKey</span>: [<span class="string">&#x27;todos&#x27;</span>] &#125;)</span><br></pre></td></tr></table></figure>



<h3 id="查询匹配"><a href="#查询匹配" class="headerlink" title="查询匹配"></a>查询匹配</h3><ol>
<li>使查询键中以指定内容开头的查询无效</li>
</ol>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> queryClient = useQueryClient()</span><br><span class="line">queryClient.invalidateQueries(&#123; <span class="attr">queryKey</span>: [<span class="string">&#x27;todos&#x27;</span>] &#125;)</span><br><span class="line"><span class="comment">// 以下两个查询都会被标记为失效</span></span><br><span class="line">useQuery(&#123;</span><br><span class="line">  <span class="attr">queryKey</span>: [<span class="string">&#x27;todos&#x27;</span>],</span><br><span class="line">  <span class="attr">queryFn</span>: ,</span><br><span class="line">&#125;)</span><br><span class="line">useQuery(&#123;</span><br><span class="line">  <span class="attr">queryKey</span>: [<span class="string">&#x27;todos&#x27;</span>, &#123; <span class="attr">page</span>: <span class="number">1</span>  &#125;],</span><br><span class="line">  <span class="attr">queryFn</span>: ,</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>传递更具体的查询键</li>
</ol>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> queryClient = useQueryClient()</span><br><span class="line">queryClient.invalidateQueries(&#123; <span class="attr">queryKey</span>: [<span class="string">&#x27;todos&#x27;</span>, &#123; <span class="attr">type</span>: <span class="string">&#x27;done&#x27;</span> &#125; ] &#125;)</span><br><span class="line"><span class="comment">// 这个查询会被标记为失效</span></span><br><span class="line">useQuery(&#123;</span><br><span class="line">  <span class="attr">queryKey</span>: [<span class="string">&#x27;todos&#x27;</span>, &#123; <span class="attr">type</span>: <span class="string">&#x27;done&#x27;</span> &#125;],</span><br><span class="line">  <span class="attr">queryFn</span>: ,</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">// 这个查询依然有效</span></span><br><span class="line">useQuery(&#123;</span><br><span class="line">  <span class="attr">queryKey</span>: [<span class="string">&#x27;todos&#x27;</span>],</span><br><span class="line">  <span class="attr">queryFn</span>: ,</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<ol start="3">
<li>严格匹配，传递<code>exact: true</code>选项，保证匹配仅有传递的查询键不包括更多变量的查询</li>
</ol>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">queryClient.invalidateQueries(&#123;</span><br><span class="line">  <span class="attr">queryKey</span>: [<span class="string">&#x27;todos&#x27;</span>],</span><br><span class="line">  <span class="attr">exact</span>: <span class="literal">true</span>,</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 这个查询会被标记为失效</span></span><br><span class="line"><span class="keyword">const</span> todoListQuery = useQuery(&#123;</span><br><span class="line">  <span class="attr">queryKey</span>: [<span class="string">&#x27;todos&#x27;</span>],</span><br><span class="line">  <span class="attr">queryFn</span>: fetchTodoList,</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 这个查询还有额外的查询键，所以不会失效</span></span><br><span class="line"><span class="keyword">const</span> todoListQuery = useQuery(&#123;</span><br><span class="line">  <span class="attr">queryKey</span>: [<span class="string">&#x27;todos&#x27;</span>, &#123; <span class="attr">type</span>: <span class="string">&#x27;done&#x27;</span> &#125;],</span><br><span class="line">  <span class="attr">queryFn</span>: fetchTodoList,</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<ol start="4">
<li>传递<code>predicate</code>函数实现更细粒度控制，此函数从缓存中接受每个<code>Query</code>实例，允许返回<code>true / false</code>决定是否失效</li>
</ol>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">queryClient.invalidateQueries(&#123;</span><br><span class="line">  <span class="attr">predicate</span>: <span class="function">(<span class="params">query</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> query.queryKey[<span class="number">0</span>] === <span class="string">&#x27;todos&#x27;</span> &amp;&amp; query.queryKey[<span class="number">1</span>]?.version &gt;= <span class="number">10</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">// 这个查询会被标记为失效</span></span><br><span class="line">useQuery(&#123;</span><br><span class="line">  <span class="attr">queryKey</span>: [<span class="string">&#x27;todos&#x27;</span>, &#123; <span class="attr">version</span>: <span class="number">20</span> &#125;],</span><br><span class="line">  <span class="attr">queryFn</span>: ,</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">// 这个查询也会被标记为失效</span></span><br><span class="line">useQuery(&#123;</span><br><span class="line">  <span class="attr">queryKey</span>: [<span class="string">&#x27;todos&#x27;</span>, &#123; <span class="attr">version</span>: <span class="number">10</span> &#125;]</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">// 这个查询的version小于10，不会被标记为失效</span></span><br><span class="line">useQuery(&#123;</span><br><span class="line">  <span class="attr">queryKey</span>: [<span class="string">&#x27;todos&#x27;</span>, &#123; <span class="attr">version</span>: <span class="number">5</span> &#125;]</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>



<h3 id="Mutation导致的失效"><a href="#Mutation导致的失效" class="headerlink" title="Mutation导致的失效"></a>Mutation导致的失效</h3><p>通常，当应用中的<code>mutation</code>执行成功时，应用程序中很可能存在需要失效并可能重新提取的相关查询，以考虑带来的新更改。</p>
<p>为此，您可以使用 <code>useMutation</code> 的 <code>onSuccess</code> 选项和<code>client</code>的 <code>invalidateQueries</code> 函数</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">useMutation(&#123;</span><br><span class="line">  mutationFn: ,</span><br><span class="line">  onSuccess: () =&gt; &#123;</span><br><span class="line">  	queryClient.invalidateQueries(&#123; queryKey: [&#x27;todos&#x27;] &#125;)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>





<h2 id="Nextjs示例"><a href="#Nextjs示例" class="headerlink" title="Nextjs示例"></a>Nextjs示例</h2><p>由于目前还没接触到数据库相关内容，做示例太过于局限，所以决定在下一章节讲 <code>Prisma 与 Nextjs</code> 的配合使用，然后基于讲过的内容做一个相对简单但是增删改查覆盖全面的示例。</p>
</div><div class="article-licensing box"><div class="licensing-title"><p>三、ReactQuery数据获取</p><p><a href="https://zhaolei-hu.github.io/2024/06/08/三、ReactQuery数据获取/">https://zhaolei-hu.github.io/2024/06/08/三、ReactQuery数据获取/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>作者</h6><p>胡兆磊</p></div></div><div class="level-item is-narrow"><div><h6>发布于</h6><p>2024-06-08</p></div></div><div class="level-item is-narrow"><div><h6>更新于</h6><p>2024-06-21</p></div></div><div class="level-item is-narrow"><div><h6>许可协议</h6><p><a class="icons" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="icon fab fa-creative-commons"></i></a><a class="icons" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="icon fab fa-creative-commons-by"></i></a><a class="icons" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="icon fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><!--!--></article></div><!--!--><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/2024/06/23/%E5%9B%9B%E3%80%81Prisma%E6%93%8D%E4%BD%9C%E6%95%B0%E6%8D%AE%E5%BA%93/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">四、Prisma操作数据库</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2024/05/22/%E4%BA%8C%E3%80%81ShadcnUI%E7%BB%84%E4%BB%B6%E5%BA%94%E7%94%A8/"><span class="level-item">二、ShadcnUI组件</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><!--!--></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1 is-sticky"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar is-rounded" src="/img/avatar.jpg" alt="「胡」Hu"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">「胡」Hu</p><p class="is-size-6 is-block">新鲜出炉的前端小白,如有问题请联系zhaolei_hu@foxmail.com</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>ChongQing, China</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">文章</p><a href="/archives"><p class="title">99</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">分类</p><a href="/categories"><p class="title">23</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">标签</p><a href="/tags"><p class="title">67</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/zhaolei-hu" target="_blank" rel="noopener">关注我</a></div></div></div><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">分类</h3><ul class="menu-list"><li><a class="level is-mobile" href="/categories/Go%E8%AF%AD%E8%A8%80/"><span class="level-start"><span class="level-item">Go语言</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/NextJs%E5%85%A8%E6%A0%88%E5%BC%80%E5%8F%91/"><span class="level-start"><span class="level-item">NextJs全栈开发</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li><li><a class="level is-mobile" href="/categories/NodeJs/"><span class="level-start"><span class="level-item">NodeJs</span></span><span class="level-end"><span class="level-item tag">28</span></span></a><ul><li><a class="level is-mobile" href="/categories/NodeJs/EggJs/"><span class="level-start"><span class="level-item">EggJs</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/categories/NodeJs/NestJs%E5%AD%A6%E4%B9%A0%E6%97%A5%E8%AE%B0/"><span class="level-start"><span class="level-item">NestJs学习日记</span></span><span class="level-end"><span class="level-item tag">8</span></span></a></li><li><a class="level is-mobile" href="/categories/NodeJs/NestJs%E8%BF%9B%E9%98%B6%E5%AD%A6%E4%B9%A0/"><span class="level-start"><span class="level-item">NestJs进阶学习</span></span><span class="level-end"><span class="level-item tag">12</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/%E5%89%8D%E7%AB%AF/"><span class="level-start"><span class="level-item">前端</span></span><span class="level-end"><span class="level-item tag">43</span></span></a><ul><li><a class="level is-mobile" href="/categories/%E5%89%8D%E7%AB%AF/CSS/"><span class="level-start"><span class="level-item">CSS</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/categories/%E5%89%8D%E7%AB%AF/ElementUI%E7%BB%84%E4%BB%B6%E5%BA%93/"><span class="level-start"><span class="level-item">ElementUI组件库</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/%E5%89%8D%E7%AB%AF/Javascript/"><span class="level-start"><span class="level-item">Javascript</span></span><span class="level-end"><span class="level-item tag">14</span></span></a></li><li><a class="level is-mobile" href="/categories/%E5%89%8D%E7%AB%AF/Scss/"><span class="level-start"><span class="level-item">Scss</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/%E5%89%8D%E7%AB%AF/TypeScript/"><span class="level-start"><span class="level-item">TypeScript</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/%E5%89%8D%E7%AB%AF/Vue/"><span class="level-start"><span class="level-item">Vue</span></span><span class="level-end"><span class="level-item tag">8</span></span></a></li><li><a class="level is-mobile" href="/categories/%E5%89%8D%E7%AB%AF/Yarn/"><span class="level-start"><span class="level-item">Yarn</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/%E5%89%8D%E7%AB%AF/axios0-18-0%E6%BA%90%E7%A0%81%E5%AD%A6%E4%B9%A0/"><span class="level-start"><span class="level-item">axios0.18.0源码学习</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li><li><a class="level is-mobile" href="/categories/%E5%89%8D%E7%AB%AF/canvas/"><span class="level-start"><span class="level-item">canvas</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/%E5%89%8D%E7%AB%AF/%E6%BA%90%E7%A0%81%E5%AD%A6%E4%B9%A0/"><span class="level-start"><span class="level-item">源码学习</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/"><span class="level-start"><span class="level-item">数据结构与算法</span></span><span class="level-end"><span class="level-item tag">16</span></span></a><ul><li><a class="level is-mobile" href="/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/LeetCode75%E5%AD%A6%E4%B9%A0%E8%AE%A1%E5%88%92/"><span class="level-start"><span class="level-item">LeetCode75学习计划</span></span><span class="level-end"><span class="level-item tag">12</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/%E6%9C%AA%E5%88%86%E7%B1%BB%E5%86%85%E5%AE%B9/"><span class="level-start"><span class="level-item">未分类内容</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/%E8%B7%A8%E7%AB%AF%E5%BC%80%E5%8F%91/"><span class="level-start"><span class="level-item">跨端开发</span></span><span class="level-end"><span class="level-item tag">2</span></span></a><ul><li><a class="level is-mobile" href="/categories/%E8%B7%A8%E7%AB%AF%E5%BC%80%E5%8F%91/Flutter/"><span class="level-start"><span class="level-item">Flutter</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/%E9%B8%BF%E8%92%99HarmonyOS/"><span class="level-start"><span class="level-item">鸿蒙HarmonyOS</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></div></div></div><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">最新文章</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2025-06-08T11:45:15.000Z">2025-06-08</time></p><p class="title"><a href="/2025/06/08/%E5%8D%81%E4%BA%8C%E3%80%81%E5%85%A8%E5%B1%80%E6%A8%A1%E5%9D%97/">十二、全局模块</a></p><p class="categories"><a href="/categories/NodeJs/">NodeJs</a> / <a href="/categories/NodeJs/NestJs%E8%BF%9B%E9%98%B6%E5%AD%A6%E4%B9%A0/">NestJs进阶学习</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2025-05-11T02:40:08.000Z">2025-05-11</time></p><p class="title"><a href="/2025/05/11/%E5%8D%81%E4%B8%80%E3%80%81%E6%A8%A1%E5%9D%97%E7%9A%84%E9%87%8D%E6%96%B0%E5%AF%BC%E5%87%BA/">十一、模块的重新导出</a></p><p class="categories"><a href="/categories/NodeJs/">NodeJs</a> / <a href="/categories/NodeJs/NestJs%E8%BF%9B%E9%98%B6%E5%AD%A6%E4%B9%A0/">NestJs进阶学习</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2025-05-06T02:35:51.000Z">2025-05-06</time></p><p class="title"><a href="/2025/05/06/%E5%8D%81%E3%80%81%E6%A8%A1%E5%9D%97%E7%9A%84%E5%AF%BC%E5%85%A5/">十、模块的导入</a></p><p class="categories"><a href="/categories/NodeJs/">NodeJs</a> / <a href="/categories/NodeJs/NestJs%E8%BF%9B%E9%98%B6%E5%AD%A6%E4%B9%A0/">NestJs进阶学习</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2025-04-26T06:30:26.000Z">2025-04-26</time></p><p class="title"><a href="/2025/04/26/%E4%B9%9D%E3%80%81Provider%E5%92%8CDI/">九、Provider和DI</a></p><p class="categories"><a href="/categories/NodeJs/">NodeJs</a> / <a href="/categories/NodeJs/NestJs%E8%BF%9B%E9%98%B6%E5%AD%A6%E4%B9%A0/">NestJs进阶学习</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2025-04-08T02:28:12.000Z">2025-04-08</time></p><p class="title"><a href="/2025/04/08/%E5%85%AB%E3%80%81IOC%E5%AE%B9%E5%99%A8%E7%A4%BA%E4%BE%8B%E5%92%8CSOLID%E5%8E%9F%E5%88%99/">八、IOC容器示例和SOLID原则</a></p><p class="categories"><a href="/categories/NodeJs/">NodeJs</a> / <a href="/categories/NodeJs/NestJs%E8%BF%9B%E9%98%B6%E5%AD%A6%E4%B9%A0/">NestJs进阶学习</a></p></div></article></div></div><div class="card widget" data-type="archives"><div class="card-content"><div class="menu"><h3 class="menu-label">归档</h3><ul class="menu-list"><li><a class="level is-mobile" href="/archives/2025/06/"><span class="level-start"><span class="level-item">六月 2025</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2025/05/"><span class="level-start"><span class="level-item">五月 2025</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2025/04/"><span class="level-start"><span class="level-item">四月 2025</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2025/03/"><span class="level-start"><span class="level-item">三月 2025</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2025/01/"><span class="level-start"><span class="level-item">一月 2025</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2024/12/"><span class="level-start"><span class="level-item">十二月 2024</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2024/10/"><span class="level-start"><span class="level-item">十月 2024</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2024/09/"><span class="level-start"><span class="level-item">九月 2024</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2024/07/"><span class="level-start"><span class="level-item">七月 2024</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2024/06/"><span class="level-start"><span class="level-item">六月 2024</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/archives/2024/05/"><span class="level-start"><span class="level-item">五月 2024</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2024/04/"><span class="level-start"><span class="level-item">四月 2024</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2024/03/"><span class="level-start"><span class="level-item">三月 2024</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2024/02/"><span class="level-start"><span class="level-item">二月 2024</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2024/01/"><span class="level-start"><span class="level-item">一月 2024</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/12/"><span class="level-start"><span class="level-item">十二月 2023</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/11/"><span class="level-start"><span class="level-item">十一月 2023</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/10/"><span class="level-start"><span class="level-item">十月 2023</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/09/"><span class="level-start"><span class="level-item">九月 2023</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/08/"><span class="level-start"><span class="level-item">八月 2023</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/07/"><span class="level-start"><span class="level-item">七月 2023</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/06/"><span class="level-start"><span class="level-item">六月 2023</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/04/"><span class="level-start"><span class="level-item">四月 2023</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/03/"><span class="level-start"><span class="level-item">三月 2023</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/02/"><span class="level-start"><span class="level-item">二月 2023</span></span><span class="level-end"><span class="level-item tag">7</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/01/"><span class="level-start"><span class="level-item">一月 2023</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/10/"><span class="level-start"><span class="level-item">十月 2022</span></span><span class="level-end"><span class="level-item tag">7</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/09/"><span class="level-start"><span class="level-item">九月 2022</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/08/"><span class="level-start"><span class="level-item">八月 2022</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/07/"><span class="level-start"><span class="level-item">七月 2022</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/06/"><span class="level-start"><span class="level-item">六月 2022</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/05/"><span class="level-start"><span class="level-item">五月 2022</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/04/"><span class="level-start"><span class="level-item">四月 2022</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/03/"><span class="level-start"><span class="level-item">三月 2022</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/02/"><span class="level-start"><span class="level-item">二月 2022</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/12/"><span class="level-start"><span class="level-item">十二月 2021</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/11/"><span class="level-start"><span class="level-item">十一月 2021</span></span><span class="level-end"><span class="level-item tag">7</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/10/"><span class="level-start"><span class="level-item">十月 2021</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li></ul></div></div></div><div class="card widget" data-type="tags"><div class="card-content"><div class="menu"><h3 class="menu-label">标签</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/BFS/"><span class="tag">BFS</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/CSS/"><span class="tag">CSS</span><span class="tag">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/DFS/"><span class="tag">DFS</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Dart/"><span class="tag">Dart</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Database/"><span class="tag">Database</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Decorator/"><span class="tag">Decorator</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/EggJs/"><span class="tag">EggJs</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/EggJss/"><span class="tag">EggJss</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ElementUI/"><span class="tag">ElementUI</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/EventEmitter/"><span class="tag">EventEmitter</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Flutter/"><span class="tag">Flutter</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/GetX/"><span class="tag">GetX</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Gin/"><span class="tag">Gin</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Go/"><span class="tag">Go</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/HarmonyOS/"><span class="tag">HarmonyOS</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/IndexedDB/"><span class="tag">IndexedDB</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/JavaScript/"><span class="tag">JavaScript</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Javascript/"><span class="tag">Javascript</span><span class="tag">13</span></a></div><div class="control"><a class="tags has-addons" href="/tags/LeetCode/"><span class="tag">LeetCode</span><span class="tag">12</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Mongodb/"><span class="tag">Mongodb</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Mysql/"><span class="tag">Mysql</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/NestJs/"><span class="tag">NestJs</span><span class="tag">20</span></a></div><div class="control"><a class="tags has-addons" href="/tags/NodeJs/"><span class="tag">NodeJs</span><span class="tag">28</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Promise/"><span class="tag">Promise</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Proxy/"><span class="tag">Proxy</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Python/"><span class="tag">Python</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Reflect/"><span class="tag">Reflect</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Sass/"><span class="tag">Sass</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Scss/"><span class="tag">Scss</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/TypeScript/"><span class="tag">TypeScript</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Vue/"><span class="tag">Vue</span><span class="tag">10</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Vue-Router/"><span class="tag">Vue-Router</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Web-Storage/"><span class="tag">Web Storage</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/axios/"><span class="tag">axios</span><span class="tag">7</span></a></div><div class="control"><a class="tags has-addons" href="/tags/canvas/"><span class="tag">canvas</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/cli/"><span class="tag">cli</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/cron%E8%A1%A8%E8%BE%BE%E5%BC%8F/"><span class="tag">cron表达式</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/hexo/"><span class="tag">hexo</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/log4js/"><span class="tag">log4js</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/lunarvim/"><span class="tag">lunarvim</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/monorepo/"><span class="tag">monorepo</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/mustache/"><span class="tag">mustache</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/neovim/"><span class="tag">neovim</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/pinia/"><span class="tag">pinia</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/typescript/"><span class="tag">typescript</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/yarn/"><span class="tag">yarn</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E4%BA%8C%E5%88%86%E6%9F%A5%E6%89%BE/"><span class="tag">二分查找</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E4%BA%8C%E5%8F%89%E6%90%9C%E7%B4%A2%E6%A0%91/"><span class="tag">二叉搜索树</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E4%BA%8C%E5%8F%89%E6%A0%91/"><span class="tag">二叉树</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%89%8D%E7%BC%80%E5%92%8C/"><span class="tag">前缀和</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%89%8D%E7%BC%80%E6%A0%91/"><span class="tag">前缀树</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/"><span class="tag">动态规划</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%8F%8C%E6%8C%87%E9%92%88/"><span class="tag">双指针</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%93%88%E5%B8%8C%E8%A1%A8/"><span class="tag">哈希表</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%93%88%E5%B8%8C%E9%9B%86%E5%90%88/"><span class="tag">哈希集合</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%9B%BE/"><span class="tag">图</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%AD%97%E7%AC%A6%E4%B8%B2/"><span class="tag">字符串</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/"><span class="tag">排序算法</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%95%B0%E7%BB%84/"><span class="tag">数组</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"><span class="tag">文件上传</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%A0%88/"><span class="tag">栈</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%BA%90%E7%A0%81/"><span class="tag">源码</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%BB%91%E5%8A%A8%E7%AA%97%E5%8F%A3/"><span class="tag">滑动窗口</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E8%83%8C%E5%8C%85%E9%97%AE%E9%A2%98/"><span class="tag">背包问题</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E8%A3%85%E9%A5%B0%E5%99%A8/"><span class="tag">装饰器</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E9%93%BE%E8%A1%A8/"><span class="tag">链表</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E9%98%9F%E5%88%97/"><span class="tag">队列</span><span class="tag">1</span></a></div></div></div></div></div><div class="column-right-shadow is-hidden-widescreen is-sticky"></div></div><div class="column column-right is-4-tablet is-4-desktop is-3-widescreen is-hidden-touch is-hidden-desktop-only order-3 is-sticky"><div class="card widget" id="toc" data-type="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">目录</h3><ul class="menu-list"><li><a class="level is-mobile" href="#快速上手"><span class="level-left"><span class="level-item">1</span><span class="level-item">快速上手</span></span></a></li><li><a class="level is-mobile" href="#Nextjs-引入-React-Query"><span class="level-left"><span class="level-item">2</span><span class="level-item">Nextjs 引入 React Query</span></span></a></li><li><a class="level is-mobile" href="#查"><span class="level-left"><span class="level-item">3</span><span class="level-item">查</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#useQuery-返回值"><span class="level-left"><span class="level-item">3.1</span><span class="level-item">useQuery 返回值</span></span></a></li><li><a class="level is-mobile" href="#queryKey"><span class="level-left"><span class="level-item">3.2</span><span class="level-item">queryKey</span></span></a></li><li><a class="level is-mobile" href="#queryFn"><span class="level-left"><span class="level-item">3.3</span><span class="level-item">queryFn</span></span></a></li><li><a class="level is-mobile" href="#query-options"><span class="level-left"><span class="level-item">3.4</span><span class="level-item">query options</span></span></a></li><li><a class="level is-mobile" href="#并行查询"><span class="level-left"><span class="level-item">3.5</span><span class="level-item">并行查询</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#手动并行查询"><span class="level-left"><span class="level-item">3.5.1</span><span class="level-item">手动并行查询</span></span></a></li><li><a class="level is-mobile" href="#使用useQueries进行动态并行查询"><span class="level-left"><span class="level-item">3.5.2</span><span class="level-item">使用useQueries进行动态并行查询</span></span></a></li></ul></li><li><a class="level is-mobile" href="#串行查询"><span class="level-left"><span class="level-item">3.6</span><span class="level-item">串行查询</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#useQuery-依赖查询"><span class="level-left"><span class="level-item">3.6.1</span><span class="level-item">useQuery 依赖查询</span></span></a></li><li><a class="level is-mobile" href="#useQueries依赖查询"><span class="level-left"><span class="level-item">3.6.2</span><span class="level-item">useQueries依赖查询</span></span></a></li></ul></li><li><a class="level is-mobile" href="#初始数据"><span class="level-left"><span class="level-item">3.7</span><span class="level-item">初始数据</span></span></a></li><li><a class="level is-mobile" href="#占位数据"><span class="level-left"><span class="level-item">3.8</span><span class="level-item">占位数据</span></span></a></li><li><a class="level is-mobile" href="#分页查询"><span class="level-left"><span class="level-item">3.9</span><span class="level-item">分页查询</span></span></a></li></ul></li><li><a class="level is-mobile" href="#增删改"><span class="level-left"><span class="level-item">4</span><span class="level-item">增删改</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#基础使用"><span class="level-left"><span class="level-item">4.1</span><span class="level-item">基础使用</span></span></a></li><li><a class="level is-mobile" href="#回调"><span class="level-left"><span class="level-item">4.2</span><span class="level-item">回调</span></span></a></li></ul></li><li><a class="level is-mobile" href="#查询失效"><span class="level-left"><span class="level-item">5</span><span class="level-item">查询失效</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#查询匹配"><span class="level-left"><span class="level-item">5.1</span><span class="level-item">查询匹配</span></span></a></li><li><a class="level is-mobile" href="#Mutation导致的失效"><span class="level-left"><span class="level-item">5.2</span><span class="level-item">Mutation导致的失效</span></span></a></li></ul></li><li><a class="level is-mobile" href="#Nextjs示例"><span class="level-left"><span class="level-item">6</span><span class="level-item">Nextjs示例</span></span></a></li></ul></div></div><style>#toc .menu-list > li > a.is-active + .menu-list { display: block; }#toc .menu-list > li > a + .menu-list { display: none; }</style><script src="/js/toc.js" defer></script></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/">「胡」说</a><p class="is-size-7"><span>&copy; 2025 胡兆磊</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.22.2/moment-with-locales.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" defer></script><script>moment.locale("zh-CN");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="回到顶端" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdnjs.cloudflare.com/ajax/libs/cookieconsent/3.1.1/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "此网站使用Cookie来改善您的体验。",
          dismiss: "知道了！",
          allow: "允许使用Cookie",
          deny: "拒绝",
          link: "了解更多",
          policy: "Cookie政策",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdnjs.cloudflare.com/ajax/libs/lightgallery/1.6.8/js/lightgallery.min.js" defer></script><script src="https://cdnjs.cloudflare.com/ajax/libs/justifiedGallery/3.7.0/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="想要查找什么..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"想要查找什么...","untitled":"(无标题)","posts":"文章","pages":"页面","categories":"分类","tags":"标签"});
        });</script></body></html>